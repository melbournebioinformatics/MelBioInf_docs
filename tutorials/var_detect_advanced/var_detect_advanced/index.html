
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../../variant_calling_galaxy_1/variant_calling_galaxy_1/">
      
      
        <link rel="next" href="../../longread_sv_calling/longread_sv_calling/">
      
      
      <link rel="icon" href="../../../img/favicon-16x16.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.22">
    
    
      
        <title>Variant Calling part 2 (Galaxy) - MBITE Tutorials</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
<script async src="https://www.googletagmanager.com/gtag/js?id=G-EMNLJD0DWP"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'G-EMNLJD0DWP');
</script>

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#variant-detection-advanced-workshop" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="MBITE Tutorials" class="md-header__button md-logo" aria-label="MBITE Tutorials" data-md-component="logo">
      
  <img src="../../../img/apple-touch-icon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MBITE Tutorials
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Variant Calling part 2 (Galaxy)
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/melbournebioinformatics/MelBioInf_docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    melbournebioinformatics/MelBioInf_docs
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="MBITE Tutorials" class="md-nav__button md-logo" aria-label="MBITE Tutorials" data-md-component="logo">
      
  <img src="../../../img/apple-touch-icon.png" alt="logo">

    </a>
    MBITE Tutorials
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/melbournebioinformatics/MelBioInf_docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    melbournebioinformatics/MelBioInf_docs
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Popular
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Popular
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://melbournebioinformatics.github.io/intro-to-git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Git for Researchers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://melbournebioinformatics.github.io/nectar-instances/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to the Nectar Cloud
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://melbournebioinformatics.github.io/intro-to-r/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to R for Biologists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://melbournebioinformatics.github.io/intro-to-rna-seq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to RNA-seq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="https://melbournebioinformatics.github.io/rna-seq-counts-to-genes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNA-seq: counts to genes
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools and skill development
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tools and skill development
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/bioinfo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    What is Bioinformatics?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/galaxy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to the Galaxy Platform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../galaxy-workflows/galaxy-workflows/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Galaxy Workflows
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python_overview/python_overview/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Python
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../unix/unix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Unix
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../intro_R_biologists/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to R for Biologists
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Genome_browsers/GenomeBrowsers_Intro/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Genome Browsers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cwl_2022/cwl_2022/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to CWL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_exp_design/rna_seq_experimental_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNA-seq Experimental Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../docker/docker/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Containerized Bioinformatics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../bionitio/bionitio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Command-line software development
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../git/git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Version Control with Git
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../janis_translate/janis_translate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workflow Translation With Janis
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Genomics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Genomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" checked>
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Variant detection
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            Variant detection
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../var_detect_advanced_background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Variant detection
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variant_calling_galaxy_1/variant_calling_galaxy_1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variant Calling part 1 (Galaxy)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Variant Calling part 2 (Galaxy)
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Variant Calling part 2 (Galaxy)
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tutorial-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-1-quality-control" class="md-nav__link">
    <span class="md-ellipsis">
      Section 1: Quality Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2-alignment-and-depth-of-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      Section 2: Alignment and depth of coverage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3-local-realignment" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3. Local realignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4-calling-variants-with-freebayes" class="md-nav__link">
    <span class="md-ellipsis">
      Section 4. Calling variants with FreeBayes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5-calling-variants-with-gatk-unified-genotyper" class="md-nav__link">
    <span class="md-ellipsis">
      Section 5. Calling variants with GATK Unified Genotyper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-6-evaluate-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Section 6. Evaluate variants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-7-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      Section 7. Annotation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../longread_sv_calling/longread_sv_calling/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Long-read Structural Variant Calling
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../variant_calling_gatk1/variant_calling_gatk1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Variant calling using command-line tools
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    de novo assembly
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            de novo assembly
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/assembly-background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to de novo assembly with Velvet
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/assembly-protocol/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to de novo genome assembly for Illumina reads
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/assembly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    de novo assembly of Illumina reads using Velvet (Galaxy)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../assembly/spades/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    de novo assembly of Illumina reads using Spades (Galaxy)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../pacbio/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    de novo assembly of PacBio reads (unix)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../hybrid_assembly/nanopore_assembly/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Hybrid genome assembly - Nanopore and Illumina
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Metabarcoding
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Metabarcoding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../qiime2/qiime2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to Metabarcoding using QIIME2: *Marine dataset*
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../qiime2_mammal/qiime2_mammal/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro to Metabarcoding using QIIME2: *Mammal dataset*
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Transcriptomics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Transcriptomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_exp_design/rna_seq_experimental_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNA-seq Experimental Design
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna-seq-lcg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNA-seq: counts to genes
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_3" >
        
          
          <label class="md-nav__link" for="__nav_5_3" id="__nav_5_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Bulk RNA-seq
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_3">
            <span class="md-nav__icon md-icon"></span>
            Bulk RNA-seq
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_dge_basic/rna_seq_basic_background/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to bulk RNAseq analysis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_dge_basic/rna_seq_basic_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNAseq analysis using HISAT2 (Galaxy)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_dge_basic/rna_seq_basic_tuxedo/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNAseq analysis using Tuxedo (Galaxy)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_dge_advanced/rna_seq_advanced_tutorial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNAseq differential expression tool comparision (Galaxy)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../rna_seq_dge_in_r/rna_seq_r/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    RNAseq differential expression in R
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_4" >
        
          
          <label class="md-nav__link" for="__nav_5_4" id="__nav_5_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Single-cell RNA-seq
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_4">
            <span class="md-nav__icon md-icon"></span>
            Single-cell RNA-seq
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../singlecell/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10X scRNA-seq analysis in R
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../seurat-de/seurat-de/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scRNA-seq Integration and Differential Expression
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../seurat-go/seurat-go/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gene Ontology (GO) and Data Integration for scRNA-seq
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Proteomics
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Proteomics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../proteomics_basic/proteomics_basic/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Identifying proteins from mass spectrometry data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Statistics and Visualisation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Statistics and Visualisation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../python_viz/python_viz/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data visualisation with Python
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Structural Modelling
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Structural Modelling
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../molecular_dynamics_101/molecular_dynamics_101/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Molecular Dynamics - Introduction to cluster computing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../molecular_dynamics_201/molecular_dynamics_201/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Molecular Dynamics - Building input files, visualising the trajectory
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Workshop Delivery Mode Information
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Workshop Delivery Mode Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../workshop_delivery_mode_info/workshops_nectar/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Workshops on Nectar Instances
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Archive
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Archive
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../unix_archive_2022/unix/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Unix-Archive
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../cwl/cwl/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to CWL
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../using_git/Using_Git/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction to Git and Github (deprecated)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tutorial-overview" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    <span class="md-ellipsis">
      Background
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#preparation" class="md-nav__link">
    <span class="md-ellipsis">
      Preparation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-1-quality-control" class="md-nav__link">
    <span class="md-ellipsis">
      Section 1: Quality Control
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-2-alignment-and-depth-of-coverage" class="md-nav__link">
    <span class="md-ellipsis">
      Section 2: Alignment and depth of coverage
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-3-local-realignment" class="md-nav__link">
    <span class="md-ellipsis">
      Section 3. Local realignment
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-4-calling-variants-with-freebayes" class="md-nav__link">
    <span class="md-ellipsis">
      Section 4. Calling variants with FreeBayes
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-5-calling-variants-with-gatk-unified-genotyper" class="md-nav__link">
    <span class="md-ellipsis">
      Section 5. Calling variants with GATK Unified Genotyper
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-6-evaluate-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Section 6. Evaluate variants
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#section-7-annotation" class="md-nav__link">
    <span class="md-ellipsis">
      Section 7. Annotation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<p>
<a href="https://www.melbournebioinformatics.org.au/"><img src="../../../img/melbioinf_logo.png" alt="Melbourne Bioinformatics logo" width="164"/></a>
<a href=http://genome.edu.au><img src="../media/gvl_logo.jpg" alt="GVL logo" align="right" width="112"/></a><br></br><br></br>
<br></br></p>
<p> </p>

<h1 id="variant-detection-advanced-workshop">Variant Detection - Advanced Workshop<a class="headerlink" href="#variant-detection-advanced-workshop" title="Permanent link">&para;</a></h1>
<h2 id="tutorial-overview">Tutorial Overview<a class="headerlink" href="#tutorial-overview" title="Permanent link">&para;</a></h2>
<p>In this tutorial, we will look further at variant calling from sequence data. We will:</p>
<ul>
<li>Align NGS read data to a reference genome and perform variant calling, using somewhat different tools to those in the Basic workshop</li>
<li>Carry out local realignment on our aligned reads</li>
<li>Compare the performance of different variant calling tools</li>
<li>Annotate our called variants with reference information</li>
</ul>
<h2 id="background">Background<a class="headerlink" href="#background" title="Permanent link">&para;</a></h2>
<p>Some background reading and reference material can be found <a href="../var_detect_advanced_background/">here</a>.</p>
<p>The slides used in this workshop can be found <a href="https://docs.google.com/presentation/d/1gsoS-ec1kCS7gBxLD4VAevhEMSsMA7TU7S8ZC_fzyEE/pub?start=false&amp;loop=false&amp;delayms=10000&amp;slide=id.gd138ad700_0_0">here</a>.</p>
<p><strong>Where is the data in this tutorial from?</strong></p>
<p>The data has been produced from human whole genomic DNA. Only reads that have mapped to a part of chromosome 20 have been used, to make the data suitable for an interactive tutorial. There are about one million 100bp reads in the dataset, produced on an Illumina HiSeq2000. This data was generated as part of the 1000 Genomes project: <a href="http://www.1000genomes.org/">http://www.1000genomes.org/</a></p>
<h2 id="preparation">Preparation<a class="headerlink" href="#preparation" title="Permanent link">&para;</a></h2>
<ol>
<li>
<p><strong>Make sure you have an instance of Galaxy ready to go.</strong></p>
<ul>
<li>If you don&rsquo;t have your own - go to our <a href="http://galaxy-tut.genome.edu.au/galaxy">Galaxy-Tut</a> or <a href="https://usegalaxy.org.au/">Galaxy Australia</a> server.</li>
<li>Log in so that your work will be saved.
If you don&rsquo;t already have an account on this server, select from the menu <em>User -&gt; Register</em> and create one.</li>
</ul>
</li>
<li>
<p><strong>Import data for the tutorial.</strong></p>
<ul>
<li>
<p>We will import a pair of FASTQ files containing paired-end reads, and a
  VCF file of known human variants to use for variant evaluation.</p>
</li>
<li>
<p><strong>Method 1: Paste/Fetch data from a URL to Galaxy.</strong></p>
</li>
<li>In the Galaxy tools panel (left), under <em>BASIC TOOLS</em>, click on <em>Get Data</em> and choose <em>Upload File</em>.</li>
<li>Get the FASTQ files: click <em>Paste/Fetch data</em> and enter these URLs into the text box.
If you put them in the same upload box, make sure there is a newline between the URLs so that they are really on separate lines.</li>
</ul>
</li>
</ol>
<div class=code>
https://swift.rc.nectar.org.au:8888/v1/AUTH_377/public/variantCalling_ADVNCD/NA12878.hiseq.wgs_chr20_2mb.30xPE.fastq_1
<br>
https://swift.rc.nectar.org.au:8888/v1/AUTH_377/public/variantCalling_ADVNCD/NA12878.hiseq.wgs_chr20_2mb.30xPE.fastq_2
<br>
</div>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">*</span><span class="w"> </span><span class="nx">Select</span><span class="w"> </span><span class="o">*</span><span class="nx">Type</span><span class="o">*</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">**</span><span class="nx">fastqsanger</span><span class="o">**</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">click</span><span class="w"> </span><span class="o">*</span><span class="nx">Start</span><span class="o">*</span><span class="p">.</span><span class="w"> </span><span class="nx">Note</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">you</span><span class="w"> </span><span class="nx">cannot</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">Auto</span><span class="o">-</span><span class="nx">detect</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">here</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">there</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">different</span><span class="w"> </span><span class="nx">subtypes</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">FASTQ</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">Galaxy</span><span class="w"> </span><span class="nx">can</span><span class="err">&#39;</span><span class="nx">t</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">sure</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">which</span><span class="p">.</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Get</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">VCF</span><span class="w"> </span><span class="nx">file</span><span class="p">:</span><span class="w"> </span><span class="nx">click</span><span class="w"> </span><span class="o">*</span><span class="nx">Paste</span><span class="o">/</span><span class="nx">Fetch</span><span class="w"> </span><span class="nx">data</span><span class="o">*</span><span class="w"> </span><span class="nx">again</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">new</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="nx">box</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">paste</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">following</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">into</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">box</span>
</code></pre></div></td></tr></table></div>

<div class=code>
https://swift.rc.nectar.org.au:8888/v1/AUTH_377/public/variantCalling_ADVNCD/dbSNP135_excludingsitesafter129_chr20.vcf
<br>
</div>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">*</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">leave</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="o">*</span><span class="n">Type</span><span class="o">*</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">Auto</span><span class="o">-</span><span class="n">detect</span><span class="o">.</span><span class="w"> </span><span class="n">Click</span><span class="w"> </span><span class="o">*</span><span class="n">Start</span><span class="o">*.</span>
<span class="o">*</span><span class="w"> </span><span class="n">Once</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">upload</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">both</span><span class="w"> </span><span class="n">sets</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">turns</span><span class="w"> </span><span class="o">*</span><span class="n">green</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">click</span><span class="w"> </span><span class="o">*</span><span class="n">Close</span><span class="o">*.</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Galaxy</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">panel</span><span class="w"> </span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span>

<span class="o">*</span><span class="w"> </span><span class="o">**</span><span class="n">Method</span><span class="w"> </span><span class="mi">2</span><span class="p">:</span><span class="w"> </span><span class="n">Upload</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">Galaxy</span><span class="o">.**</span><span class="w"> </span><span class="p">(</span><span class="n">In</span><span class="w"> </span><span class="n">most</span><span class="w"> </span><span class="n">cases</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">won</span><span class="s1">&#39;t need this for the tutorial)</span>
<span class="o">*</span><span class="w"> </span><span class="o">*</span><span class="n">Use</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">own</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">upload</span><span class="p">,</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">reason</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">need</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">manually</span><span class="w"> </span><span class="n">download</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tutorial</span><span class="o">.*</span>
<span class="o">*</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Galaxy</span><span class="w"> </span><span class="n">tools</span><span class="w"> </span><span class="n">panel</span><span class="w"> </span><span class="p">(</span><span class="n">left</span><span class="p">),</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="o">*</span><span class="n">BASIC</span><span class="w"> </span><span class="n">TOOLS</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">click</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="o">*</span><span class="n">Get</span><span class="w"> </span><span class="n">Data</span><span class="o">*</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">choose</span><span class="w"> </span><span class="o">*</span><span class="n">Upload</span><span class="w"> </span><span class="n">File</span><span class="o">*.</span>
<span class="o">*</span><span class="w"> </span><span class="n">Click</span><span class="w"> </span><span class="o">*</span><span class="n">Choose</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">file</span><span class="o">*</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">downloaded</span><span class="w">  </span><span class="n">FASTQ</span><span class="w"> </span><span class="n">files</span><span class="o">.</span><span class="w"> </span><span class="n">Select</span><span class="w"> </span><span class="o">*</span><span class="n">Type</span><span class="o">*</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="o">**</span><span class="n">fastqsanger</span><span class="o">**</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">click</span><span class="w"> </span><span class="o">*</span><span class="n">Start</span><span class="o">*.</span>
<span class="o">*</span><span class="w"> </span><span class="n">Click</span><span class="w"> </span><span class="o">*</span><span class="n">Choose</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">file</span><span class="o">*</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">downloaded</span><span class="w"> </span><span class="n">VCF</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="w"> </span><span class="n">Click</span><span class="w"> </span><span class="o">*</span><span class="n">Start</span><span class="o">*.</span>
<span class="o">*</span><span class="w"> </span><span class="n">Once</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">upload</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">turns</span><span class="w"> </span><span class="o">*</span><span class="n">green</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">click</span><span class="w"> </span><span class="o">*</span><span class="n">Close</span><span class="o">*.</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">see</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">three</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Galaxy</span><span class="w"> </span><span class="n">history</span><span class="w"> </span><span class="n">panel</span><span class="w"> </span><span class="p">(</span><span class="n">right</span><span class="p">)</span><span class="o">.</span>
</code></pre></div></td></tr></table></div>

<ol start="3">
<li><strong>Rename the datasets</strong><ul>
<li>You should now have three files in your History, shown in the right-hand panel. If you used Method 1, the name of each dataset will be the full URL we got the file from. For convenience, we will give the datasets shorter names.</li>
<li>Click on the pencil icon to the top right of the dataset name (inside the green box) for the first dataset in your History. Note that the first dataset will be at the bottom! Shorten the name (you can just delete the first part) so that it is <strong>NA12878.hiseq.wgs_chr20_2mb.30xPE.fastq_1</strong>. Click <em>Save</em>.</li>
<li>Similarly, rename the second dataset to <strong>NA12878.hiseq.wgs_chr20_2mb.30xPE.fastq_2</strong>.</li>
<li>Similarly, rename the third dataset to <strong>dbSNP135_excludingsitesafter129.chr20.vcf</strong>.</li>
</ul>
</li>
</ol>
<h2 id="section-1-quality-control">Section 1: Quality Control<a class="headerlink" href="#section-1-quality-control" title="Permanent link">&para;</a></h2>
<p>The aim here is to evaluate the quality of the short data. If the quality is poor, then adjustments can be made - eg trimming the short reads, or adjusting your expectations of the final outcome!</p>
<ol>
<li><strong>Analyse the quality of the reads in the FASTQ file.</strong><ul>
<li>From the left hand tool panel in Galaxy, under <em>NGS ANALYSIS</em>, select <em>NGS: QC and manipulation -&gt; FastQC</em></li>
<li>Select one of the FASTQ files as input and <em>Execute</em> the tool.</li>
<li>When the tool finishes running, you should have an HTML file in your History. Click on the eye icon to view the various quality metrics.</li>
</ul>
</li>
</ol>
<p>Look at the generated FastQC metrics. This data looks pretty good - high per-base quality scores (most above 30).</p>
<h2 id="section-2-alignment-and-depth-of-coverage">Section 2: Alignment and depth of coverage<a class="headerlink" href="#section-2-alignment-and-depth-of-coverage" title="Permanent link">&para;</a></h2>
<p>In this step we map each of the individual reads in the sample FASTQ readsets to a reference genome, so that we will be able to identify the sequence changes with respect to the reference genome.</p>
<p>Some of the variant callers need extra information regarding the source of reads in order to identify the correct error profiles to use in their statistical variant detection model, so we add more information into the alignment step so that that generated BAM file contains the metadata the variant caller expects.</p>
<p>We will also examine the depth of coverage of the aligned reads across the genome, as a quality check on both the sequencing experiment and the alignment.</p>
<ol>
<li>
<p><strong>Map/align the reads with Bowtie2 to the human reference genome.</strong> We will use Bowtie2, which is one of several good alignment tools for DNA-seq data. Under <em>NGS ANALYSIS</em> in the tools panel, select the tool <em>NGS: Mapping -&gt; Bowtie2</em>.</p>
<ul>
<li>We have paired-end reads in two FASTQ files, so select <em>paired-end</em>.</li>
<li>Select the two FASTQ files as inputs.</li>
<li>Under <em>Select reference genome</em> select the human genome <em>hg19</em>.</li>
<li>Next we will add read group information. Read groups are usually used when we have reads from multiple experiments, libraries or samples, and want to put them into one aligned BAM file while remembering which read came from which group. In our case we only have one group, but the GATK tools need us to specify a read group in order to work correctly. Under <em>Set read groups information?</em> select <em>Set read groups (SAM/BAM specification)</em>. (Picard-style should also work.)<ul>
<li>Set the read group identifier to &ldquo;Tutorial_readgroup&rdquo;. This identifier needs to be a unique identifier for this read group. Since we only have one read group, it doesn&rsquo;t matter much what it is, but a common practice is to construct it out of information guaranteed to be unique, such as the library identifier plus Platform Unit (e.g. flowcell) identifier.</li>
<li>Set the sample name to &ldquo;NA12878&rdquo;</li>
<li>Set the platform to <em>ILLUMINA</em></li>
<li>Set the library name to &ldquo;Tutorial_library&rdquo;. Normally we would set this to identify the DNA library from our DNA extraction.</li>
</ul>
</li>
<li>You can leave other read group information blank, and use default Bowtie2 settings. <em>Execute</em> the tool.</li>
<li>When the alignment has finished, you should rename the BAM file to something more convenient, such as <strong>NA12878.chr20_2mb.30xPE.bam</strong>.</li>
<li><em>Note: we assume that you have seen BAM and SAM files before. If you have not you may want to try out the Basic Variant Calling workshop, or take the time now to convert your BAM file to a SAM file and examine the contents.</em></li>
</ul>
</li>
<li>
<p><strong>Visualise the aligned BAM file with IGV.</strong> The Integrated Genome Viewer, IGV, is a very popular tool for visualising aligned NGS data. It will run on your computer (not on the server).</p>
<ul>
<li><em>Note: if you are already familiar with IGV, you may want to go through this section quickly, but it&rsquo;s still a good idea to launch IGV for use in later steps.</em></li>
<li>In the green dataset box for your BAM file in the history panel, you will see some <em>display with IGV</em> links. Launch IGV by clicking the <em>web current</em> link. If IGV is already running on your computer, instead click the <em>local</em> link. If you have problems you can instead launch IGV by visiting <a href="https://www.broadinstitute.org/software/igv/download">https://www.broadinstitute.org/software/igv/download</a>.</li>
<li><em>If</em> your BAM file was not automatically loaded, download and open it:<ul>
<li>Download the BAM file AND the BAM index (BAI file) by clicking the floppy-disk icon in the green dataset window and selecting each file in turn. Make sure these two files are in the same directory.</li>
<li>In IGV, select the correct reference genome, <em>hg19</em>, in the top-left drop-down menu.</li>
<li>In IGV, open the BAM file using <em>File -&gt; Load from File</em>.</li>
</ul>
</li>
<li>Select chr20 in the IGV chromosomal region drop down box (top of IGV, on the left next to the organism drop down box).</li>
<li>Zoom in to the left hand end of chromosome 20 to see the read alignments - remember our reads only cover the first 2mb of the chromosome.</li>
<li>Scroll around and zoom in and out in the IGV genome viewer to get a feel for genomic data. Note that coverage is variable, with some regions getting almost no coverage (e.g. try chr20:1,870,686-1,880,895 - if you zoom right in to base resolution you’ll see that this region is very GC rich, meaning it’s hard to sequence. Unfortunately it also contains the first few exons of a gene&hellip;)</li>
</ul>
</li>
<li>
<p><strong>Restrict the genomic region considered.</strong> Later steps can be computationally intensive if performed on the entire genome. We will generate a genomic interval (BED) file that we will use to restrict further analyses to the first 2mb of chromosome 20, as we know our data comes from this region.</p>
<ul>
<li>Under <em>BASIC TOOLS</em>, select the tool <em>Text manipulation -&gt; Create single interval</em>. Enter these values:<ul>
<li>Chromosome: chr20</li>
<li>Start position: 0</li>
<li>End position: 2000000</li>
<li>Name: chr20_2mb</li>
<li>Strand: plus</li>
</ul>
</li>
<li><em>Execute</em> this tool. This will create a small BED file specifying just one genomic region.</li>
<li>When the file is created, rename it to <strong>chr20_2mb.bed</strong>. Have a look at the contents of this BED file.</li>
</ul>
</li>
<li>
<p><strong>Evaluate the depth of coverage of the aligned region.</strong> Under <em>NGS COMMON TOOLSETS</em>, select the tool <em>NGS: GATK Tools 2.8 -&gt; Depth of Coverage</em>.</p>
<ul>
<li>Select the BAM file you just generated as the input BAM file.</li>
<li>Make sure the reference genome we aligned to is selected under <em>Using reference genome</em>.</li>
<li>Set <em>Output format</em> to <em>table</em>.</li>
<li>Restrict the analysis to only the region of interest: Set <em>Basic or Advanced GATK options</em> to <em>Advanced</em>. Click <em>Insert Operate on Genomic intervals</em> to add a new region and select the chr20_2mb.bed file from your history.</li>
<li><em>Execute</em>.</li>
<li>This tool will produce a lot of files. We are most interested in the summaries. Examine the contents of:<ul>
<li><strong>‘Depth of Coverage on data.... (output summary sample)’:</strong> this file  will tell you the total depth of coverage for your sample across the genome (or in our case, across the first 2mb region we specified). It gives the total and mean coverage, plus some quantiles. This will give you an idea if there is something seriously wrong with your coverage distribution.</li>
<li>Your mean depth here should be ~24x. Note that ~89% of reference bases are covered by at least 15x coverage, which is a sort of informal agreed minimum for reasonable variant calling.</li>
<li>Also have a quick look at the <strong>(per locus coverage)</strong> file. It&rsquo;s not practical to go through this by hand, but you&rsquo;ll see that it gives coverage statistics for every site in the genome.</li>
</ul>
</li>
<li>The other tables give you more detailed statistics on the level of coverage, broken down by regions etc. We don’t really need them so to keep our Galaxy history clean you can delete all the outputs of this step except for the ‘Depth of Coverage on data.... (output summary sample)’ file. Use the ‘X’ next to a history file to delete it.</li>
</ul>
</li>
</ol>
<h2 id="section-3-local-realignment">Section 3. Local realignment<a class="headerlink" href="#section-3-local-realignment" title="Permanent link">&para;</a></h2>
<p>Alignment to large genomes is a compromise between speed and accuracy. Since we usually have (at least) millions of reads, it becomes computationally too expensive to compare reads to one another - instead, high-throughput aligners such as Bowtie align each read individually to the reference genome.</p>
<p>This is often a problem where indels are present, as the aligner will be reluctant to align a read over an indel without sufficient evidence. This can lead to misalignment and to false positive SNVs. We can improve the performance of variant callers by carrying out a further step of ‘realignment’ after the initial alignment, considering all the reads in a particular genomic region collectively. In particular, this can provide enough collective evidence to realign reads correctly over suspected indels.</p>
<p>Both GATK and FreeBayes will benefit from local realignment around indels. Some tools, such as SamTools Mpileup, have alternative methods to deal with possible misalignment around indels.</p>
<p>If you skip this section, you can still carry out the variant calling steps in later sections by simply using the BAM file from Section 2.
However performing local realignment will improve the accuracy of our variant calls.</p>
<ol>
<li>
<p><strong>Generate the list of indel regions to be realigned.</strong> Under <em>NGS COMMON TOOLSETS</em>, select <em>NGS: GATK Tools 2.8 -&gt; Realigner Target Creator</em>. This tool will look for regions containing potential indels.</p>
<ul>
<li>Select your BAM file as input.</li>
<li>Select the correct reference genome (the genome used for alignment).</li>
<li>Restrict the analysis to only the region of interest: Set <em>Basic or Advanced GATK options</em> to <em>Advanced</em>. Click <em>Insert Operate on Genomic intervals</em> to add a new region and select the chr20_2mb.bed file from your history.</li>
<li><em>Execute</em>.</li>
<li>If you examine the contents of the resulting intervals file, you will see a list of genomic regions to be considered in the next step.</li>
</ul>
</li>
<li>
<p><strong>Realign the subsets of reads around the target indel areas.</strong> Under <em>NGS COMMON TOOLSETS</em>, select <em>NGS: GATK Tools 2.8 -&gt; Indel Realigner</em>. This step will realign reads and generate a new BAM file.</p>
<ul>
<li>Select your BAM file as input.</li>
<li>Select the correct reference genome.</li>
<li>Under <em>Restrict realignment to provided intervals</em>, select the intervals file generated in the previous step.</li>
<li><em>Execute</em>.</li>
<li>Rename the file to something easier to recognise, e.g. <strong>NA12878.chr20_2mb.30xPE.realigned.bam</strong></li>
<li>To keep your history clean, you may want to delete the log files generated by GATK in the last two steps.</li>
</ul>
</li>
<li>
<p><strong>Compare the realigned BAM file to original BAM around an indel.</strong></p>
<ul>
<li>Open the realigned BAM file in IGV. You can use the <em>local</em> link to open it in your already-running IGV session and compare it to the pre-realignment BAM file.</li>
<li>Generally, the new BAM should appear identical to the old BAM except in the realigned regions.</li>
<li>Find some regions with indels that have been realigned (use the ‘Realigner Target Creator on data&hellip; (GATK intervals)’ file from the first step of realignment, it has a list of the realigned regions).</li>
<li>If you can’t find anything obvious, check region chr20:1163914-1163954;
you should see that realignment has resulted in reads originally providing evidence of a ‘G/C’ variant at chr20:1163937 to be realigned with a 10bp insertion at chr20:1163835 and no evidence of the variant.</li>
</ul>
</li>
</ol>
<h2 id="section-4-calling-variants-with-freebayes">Section 4. Calling variants with FreeBayes<a class="headerlink" href="#section-4-calling-variants-with-freebayes" title="Permanent link">&para;</a></h2>
<p>FreeBayes is a Bayesian variant caller which assesses the likelihood of each possible genotype for each position in the reference genome, given the observed reads at that position, and reports back the list of variants (positions where a genotype different to homozygous reference was called). It  can be set to aggressively call all possible variants, leaving filtering to the user. FreeBayes generates a variant quality score (as do all variant callers) which can be used for filtering. FreeBayes will also give some phasing information, indicating when nearby variants appear to be on the same chromosome.</p>
<p>You can <a href="https://github.com/ekg/freebayes">read more about FreeBayes here</a>.</p>
<ol>
<li>
<p><strong>Call variants with FreeBayes.</strong> Under <em>NGS ANALYSIS</em>, select the tool <em>NGS: Variant Analysis -&gt; FreeBayes</em>.</p>
<ul>
<li>Select your realigned BAM file as input, and select the correct reference genome.</li>
<li>Under <em>Choose parameter selection level</em>, select &ldquo;Simple diploid calling with filtering and coverage&rdquo;. This will consider only aligned reads with sufficient mapping quality and base quality. You can see the exact parameters this sets by scrolling down in the main Galaxy window to the Galaxy FreeBayes documentation section on <em>Galaxy-specific options</em>.</li>
<li><em>Execute</em> FreeBayes.</li>
<li>When it has run, rename the resulting VCF file to something shorter, such as <strong>NA12878.FreeBayes.chr20_2mb.vcf</strong>.</li>
</ul>
</li>
<li>
<p><strong>Check the generated list of variants</strong>.</p>
<ul>
<li>Click the eye icon to examine the VCF file contents.</li>
<li>How many variants exactly are in your list? (Hint: you can look at the number of lines in the dataset, listed in the green box in the History, but remember the top lines are header lines.)</li>
<li>What sort of quality scores do your variants have?</li>
<li>Open the VCF file in IGV using the dataset&rsquo;s <em>display in IGV local</em> link (using the <em>web current</em> link will open IGV again, and using <em>local</em> should use your already-running IGV). This will give an annotation track in IGV to visualise where variants have been called. Compare it to your BAM file.</li>
</ul>
</li>
</ol>
<h2 id="section-5-calling-variants-with-gatk-unified-genotyper">Section 5. Calling variants with GATK Unified Genotyper<a class="headerlink" href="#section-5-calling-variants-with-gatk-unified-genotyper" title="Permanent link">&para;</a></h2>
<p>For comparison, we will call variants with a second variant caller.</p>
<p>The GATK (genome analysis toolkit) is a set of tools from the Broad Institute. It includes the tools for local realignment, used in the previous step.</p>
<p>The GATK UnifiedGenotyper is a Bayesian variant caller and genotyper. You can also use the GATK HaplotypeCaller, which should be available on the GVL server you are using. It takes a little longer to run but is a more recent and sophisticated variant caller that takes into account human haplotype information. Both of these tools are intended primarily for calling diploid, germline variants.</p>
<p>You can <a href="http://www.broadinstitute.org/gatk">read more about the GATK here</a>.</p>
<ol>
<li>
<p><strong>Call variants using Unified Genotyper.</strong> Under <em>NGS COMMON TOOLSETS</em>, select the tool <em>NGS: GATK Tools 2.8 -&gt; Unified Genotyper</em>.</p>
<ul>
<li>Select your realigned BAM file as input, and select the correct reference genome.</li>
<li>UnifiedGenotyper can automatically label called variants that correspond to known human SNPs, if we provide it with a list of these. We have a VCF file of known SNPs which you imported as input data for this workshop. Under <em>dbSNP ROD file</em>, select the dataset <em>dbsnp135_excludingsitesafter129_chr20.vcf</em>.</li>
<li>Set <em>Genotype likelihoods calculation model to employ</em> to <em>SNP</em>.</li>
<li>Restrict the analysis to only the region of interest: Set <em>Basic or Advanced GATK options</em> to <em>Advanced</em>. Click <em>Insert Operate on Genomic intervals</em> to add a new region and select the chr20_2mb.bed file from your history.</li>
<li><em>Execute</em>.</li>
<li>Rename the file to something useful eg <strong>NA12878.GATK.chr20_2mb.vcf</strong>.</li>
<li>The output file of interest is the VCF file. If you like, clean up your History by deleting the (log) and (metrics) files.</li>
</ul>
</li>
<li>
<p><strong>Check the generated list of variants.</strong></p>
<ul>
<li>Roughly how many variants are there in your VCF file (how many lines in the dataset?)</li>
<li>Click the eye icon to examine the contents of the VCF file. Notice that the <em>ID</em> column (the third column) is populated with known SNP IDs from the VCF file we provided.</li>
<li>Notice that the VCF header rows, and the corresponding information in the <em>INFO</em> column, is NOT the same as for the VCF file generated by FreeBayes. In general each variant caller gets to decide what information to put in the <em>INFO</em> column, so long as it adds header rows to describe the fields it uses.</li>
<li>Open the VCF file in IGV, using the link in the history panel.</li>
<li>Find a region where GATK has called a variant but FreeBayes hasn’t, and vice versa. Try chr20:1,123,714-1,128,378.</li>
</ul>
</li>
</ol>
<h2 id="section-6-evaluate-variants">Section 6. Evaluate variants<a class="headerlink" href="#section-6-evaluate-variants" title="Permanent link">&para;</a></h2>
<p>How can we evaluate our variants?</p>
<p>We&rsquo;ve called variants on normal human DNA, so we expect to find variants with the typical characteristics of human germline variants. We know a lot about variation in humans from many empirical studies, including the 1000Genomes project, so we have some expectations on what we should see when we call variants in a new sample:</p>
<ul>
<li>We expect to see true variations at the rate of about 1 per 1000bp against the reference genome</li>
<li>85% of variations ‘rediscovered’ - that is, 85% already known and recorded in dbSNP (% dependent on the version of dbSNP)</li>
<li>A transition/transversion (Ti/Tv) rate of &gt;2 if the variants are high quality, even higher if the variants are in coding regions.</li>
</ul>
<p>You can <a href="http://genome.sph.umich.edu/wiki/SNP_Call_Set_Properties">read more about SNP call set properties here</a>.</p>
<p>You may find that each of the variant callers has more variants than we would have expected - we would have expected around 2000 in our 2 megabase region but we see between 3000 and 5000. This is normal for variant calling, where most callers err on the side of sensitivity to reduce false negatives (missed SNVs), expecting the user to do further filtering to remove false positives (false SNVs).</p>
<p>We will also compare the output of our variant callers to one another - how many SNVs have they called in common? How many do they disagree on?</p>
<ol>
<li>
<p><strong>Evaluate dbSNP concordance and Ti/Tv ratio using the GATK VariantEval tool.</strong></p>
<ul>
<li>Under <em>NGS COMMON TOOLSETS</em>, select <em>NGS: GATK Tools 2.8 -&gt; Eval Variants</em>.</li>
<li>Under <em>Input variant file</em>, select the VCF file you generated with FreeBayes.</li>
<li>Click <em>Insert Variant</em> to add a second input file, and under <em>Input variant file</em>, select the VCF file you generated with UnifiedGenotyper.</li>
<li>Set the reference genome to <em>hg19</em>.</li>
<li>Provide our list of known variants: make sure <em>Provide a dbSNP Reference-Ordered Data (ROD) file</em> is set to <em>Set dbSNP</em> and under <em>dbSNP ROD file</em> select the input reference variant file, <strong>dbSNP135_excludingsitesafter129.chr20.vcf</strong>.</li>
<li>We will avoid carrying out the full suite of comparisons for this tutorial, and look at a couple of metrics. Set <em>Basic or Advanced Analysis options</em> to <em>Advanced</em>. Then set the following:<ul>
<li><em>Eval modules to apply on the eval track(s)</em>:<ul>
<li><em>CompOverlap</em></li>
<li><em>TiTvVariantEvaluator</em></li>
</ul>
</li>
<li><em>Do not use the standard eval modules by default</em>: check this option</li>
</ul>
</li>
<li><em>Execute</em>.</li>
</ul>
</li>
<li>
<p><strong>Interpret the dbSNP concordance section of the evaluation report.</strong></p>
<ul>
<li>Examine the contents of the ‘Eval Variants on data&hellip; (report)’</li>
<li>The first section of the report lists the overlap in variants between the generated VCF files and known human variation sites from dbSNP.<ul>
<li>The <em>EvalRod</em> column specifies which of the input VCFs is analysed (input_0 = first VCF, input_1 = second etc). For us, these should be FreeBayes and GATK respectively.</li>
<li>The <em>CompRod</em> column specifies the set of variants against which the input VCFs are being compared; we have used dbsnp.</li>
<li><em>Novelty</em>: whether the variants in this row have been found in the supplied dbSNP file or not (known = in dbSNP, novel = not in dbSNP). The rows containing <em>all</em> variants are the most informative summaries.</li>
<li><em>nEvalVariants</em>: number of variant sites in EvalRod (i.e. all called variants).</li>
<li><em>novelSites</em>: number of variant sites found in EvalRod but not CompRod (i.e. called variants not in dbSNP).</li>
<li><em>CompOverlap</em>: number of variant sites found in both EvalRod and CompRod (i.e. called variants that ARE in dbSNP).</li>
<li><em>compRate</em>: percentage of variant sites from EvalRod found in CompRod (=CompOverlap/nEvalVariants).<ul>
<li>This metric is important, and it’s what people generally refer to as <em>dbSNP concordance</em>.</li>
</ul>
</li>
<li><em>nConcordant</em> and <em>concordantRate</em>: number and percentage of overlapping variants that have the same genotype.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Interpret the TiTv section of the evaluation report.</strong></p>
<ul>
<li>The second section of the report lists the transition/transversion ratio for different groups of variants from the callsets.</li>
<li>It generally follows the table format above. The most interesting metric is in the column labelled <em>tiTvRatio</em>.</li>
<li>The expectation is a Ti/Tv close to the TiTvRatioStandard of 2.38. Generally, the higher the better, as a high Ti/Tv ratio indicates that most variants are likely to reflect our expectations from what we know about human variation.</li>
<li>In this table, it can be useful to compare not just the rows labelled <em>all</em>, but also those labelled <em>known</em> and <em>novel</em>. Is the Ti/Tv ratio different for known dbSNP variants, as compared to novel variants in this individual?</li>
</ul>
</li>
<li>
<p><strong>How much overlap is there in the call sets?</strong></p>
<ul>
<li>One way to work out how many of the variants are in common between the call sets is to produce a Venn diagram to visualise the overlap. Since all our variants are on chromosome 20, we will do this by simply comparing the positions of the SNVs. So, we will first remove the VCF headers, leaving us just the variant rows, and then we will compare the variant coordinates.</li>
<li>Remove the header lines from a VCF file: select the tool <em>BASIC TOOLS -&gt; Filter and Sort -&gt;Select</em>.<ul>
<li>As an input file, in <em>Select lines from</em>, select the VCF file you generated using FreeBayes.</li>
<li>Select <em>NOT Matching</em>.</li>
<li>As the pattern, enter &ldquo;^#&rdquo;. <em>^</em> in regular expressions indicates the start of the line, so this is a regular expression that says we are detecting lines where there is a &ldquo;#&rdquo; character at the start of the line.</li>
<li><em>Execute</em>. This should give you a new dataset, containing just the variant rows. Notice that the number of lines in this dataset now tells you how many variant calls you have!</li>
</ul>
</li>
<li>Repeat the above steps to remove the header lines from VCF file that you generated using GATK UnifiedGenotyper.</li>
<li>Create a Venn diagram: select the tool <em>STATISTICS AND VISUALISATION -&gt; Graph/Display Data -&gt; proportional venn</em>.<ul>
<li>Enter any title you like, e.g. &ldquo;FreeBayes vs UnifiedGenotyper&rdquo;.</li>
<li>As <em>Input file 1</em>, select the first of the filtered files you just generated.</li>
<li>As <em>Column index</em>, enter 1. This is the second column, i.e. the column containing the position coordinate.</li>
<li>Under <em>as name</em>, enter a name for this input file, e.g. just &ldquo;FreeBayes&rdquo;.</li>
<li>As <em>Input file 2</em>, select the second of the filtered VCF files.</li>
<li>Again as <em>Column index</em>, enter 1.</li>
<li>Under <em>as name</em>, enter a name for this input file, e.g. just &ldquo;UnifiedGenotyper&rdquo;.</li>
<li><em>Execute</em>.</li>
</ul>
</li>
<li>You should get an HTML file containing a Venn diagram, containing the overlap of the two sets of SNV calls. The counts below show how many variants are in each part of the diagram:<ul>
<li>&ldquo;FreeBayes  UnifiedGenotyper&rdquo; indicates the difference, i.e. how many variants were called by FreeBayes and <em>not</em> UnifiedGenotyper.</li>
<li>&ldquo;FreeBayes ∩ UnifiedGenotyper&rdquo; indicates the intersection, i.e. how many variants were called by both variant callers.</li>
</ul>
</li>
<li>You will probably find that FreeBayes calls variants more aggressively, and that there are more variants called by FreeBayes and not UnifiedGenotyper than vice versa. We could make FreeBayes calls more specific by filtering on e.g. variant quality score. We&rsquo;d expect this to  remove many false positives, but also a few true positives.</li>
</ul>
</li>
</ol>
<h2 id="section-7-annotation">Section 7. Annotation<a class="headerlink" href="#section-7-annotation" title="Permanent link">&para;</a></h2>
<p>The variants we have detected can be annotated with information from known reference data. This can include, for instance</p>
<ul>
<li>whether the variant corresponds to a previously-observed variant in other samples, or across the population</li>
<li>whether the variant is inside or near a known gene</li>
<li>whether the variant is in a particular kind of genomic region (exon of a gene, UTR, etc)</li>
<li>whether a variant is at a site predicted to cause a pathogenic effect on the gene when mutated</li>
</ul>
<p>&hellip; and lots of other information!</p>
<p>Most human genes have multiple isoforms, i.e. multiple alternative splicings leading to alternative transcripts. The annotation information we get for a variant in the gene can depend on which transcript is used. In some cases, unless you request only one, you may see multiple alternative annotations for one variant.</p>
<p>For this workshop we will annotate our variants with the <em>SnpEff</em> tool, which has its own prebuilt annotation databases.</p>
<ol>
<li>
<p><strong>Annotate the detected variants.</strong> Select the tool <em>NGS ANALYSIS -&gt; NGS: Annotation -&gt; SnpEff</em>.</p>
<ul>
<li>Choose any of your generated lists of variants as the input VCF file in the first field.</li>
<li>Select <em>VCF</em> as the output format as well. This will add the annotated information to the INFO column of the VCF file.</li>
<li>As <em>Genome source</em>, select <em>Named on demand</em>. Then as the genome, enter &ldquo;hg19&rdquo;. This should work on any server, even if the SnpEff annotation database for hg19 has not been previously installed.</li>
<li>Make sure <em>Produce Summary Stats</em> is set to <em>Yes</em>.</li>
<li><em>Execute</em> SnpEff.</li>
</ul>
</li>
<li>
<p><strong>Examine the annotated information.</strong> Click the eye icon on the resulting VCF file to view it.</p>
<ul>
<li>You should see more information in the INFO column for each variant.</li>
<li>You should also see a few extra VCF header rows. In particular notice the new <em>INFO=&lt;ID=EFF&hellip;</em> header row, listing the information added on the predicted effects of each variant.</li>
<li>Have a look through a few variants. Variants not inside or near known genes will not have much annotated information, and may simply have a short <em>EFF</em> field listing the variant as being in an &ldquo;intergenic region&rdquo;. Variants in known functional regions of the genome will be annotated with much more information.</li>
<li>Try filtering to view only missense variants (i.e. substitutions which cause an amino acid change) by using the Galaxy tool <em>BASIC TOOLS -&gt; Filter and Sort -&gt; Select</em> on your annotated VCF file and filtering for lines matching the string &ldquo;missense_variant&rdquo;.</li>
</ul>
</li>
<li>
<p><strong>Examine the annotation summary stats.</strong> The other file SnpEff produces is an HTML document with a summary of the annotations applied to the observed variants. Examine the contents of this file.</p>
<ul>
<li>You will see summaries of types of variants, impact of variants, functional regions etc.
 Go through these tables and graphs and see if you understand what they represent.</li>
<li>Where are most of the variants found (in exons, introns etc)? Does this match what you&rsquo;d expect?</li>
</ul>
</li>
</ol>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            <a href="https://www.melbournebioinformatics.org.au/">Melbourne Bioinformatics – The University of Melbourne ©</a>
          </div>
        
        Powered by <a href="https://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">Material for MkDocs</a>.
      </div>
      
        
<div class="md-social">
  
</div>
      
    </div>
  </div>
</footer>

      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["content.code.copy", "content.code.annotate"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>